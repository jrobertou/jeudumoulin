<html>
  <head>
    <meta charset="utf-8"></meta>
    <title>Jeu du Moulin</title>
    <script src="js/game.js"></script>
    <script src="js/player.js"></script>
    <script src="js/board.js"></script>
    <script src="js/piece.js"></script>
    <script src="js/place.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/vendor/jquery-2.0.1.min.js"></script>
    <script src="js/vendor/underscore-min.js"></script>
    <style type="text/css">
      #start_buttons {
        margin-bottom: 20px;
      }
      #settings {
        margin-bottom: 20px;
      }
      #board {
        font-size: 150%;
        font-family: monospace;
      }
      #infos {
        margin-top: 20px;
      }
      .piece {
      }
      .clickable {
        cursor: pointer;
      }
      .green {
        color: green;
      }
      .red {
        color: red;
      }
      .moving {
        font-weight: bold;
        text-transform: uppercase;
      }
    </style>
  </head>
  <body>
    <div id="start_buttons">
      <button data-player0="p" data-player1="p">P v P</button>
      <button data-player0="p" data-player1="ai">P v AI</button>
      <button data-player0="ai" data-player1="p">AI v P</button>
      <button data-player0="ai" data-player1="ai">AI v AI</button>
    </div>
    <div id="settings">
      AI wait time: <input type="text" id="ai_wait_time" value="500" />
    </div>
    <div id="board">
      <!-- Ugly shit, don't look at this please! -->
      <span class="place" data-index="0">[<span class="piece"> </span>]</span>------------<span class="place" data-index="1">[<span class="piece"> </span>]</span>------------<span class="place" data-index="2">[<span class="piece"> </span>]</span><br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;<span class="place" data-index="3">[<span class="piece"> </span>]</span>-------<span class="place" data-index="4">[<span class="piece"> </span>]</span>-------<span class="place" data-index="5">[<span class="piece"> </span>]</span>&nbsp;&nbsp;&nbsp;|<br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<span class="place" data-index="6">[<span class="piece"> </span>]</span>--<span class="place" data-index="7">[<span class="piece"> </span>]</span>--<span class="place" data-index="8">[<span class="piece"> </span>]</span>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      <span class="place" data-index="9">[<span class="piece"> </span>]</span>--<span class="place" data-index="10">[<span class="piece"> </span>]</span>--<span class="place" data-index="11">[<span class="piece"> </span>]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="place" data-index="12">[<span class="piece"> </span>]</span>--<span class="place" data-index="13">[<span class="piece"> </span>]</span>--<span class="place" data-index="14">[<span class="piece"> </span>]</span><br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<span class="place" data-index="15">[<span class="piece"> </span>]</span>--<span class="place" data-index="16">[<span class="piece"> </span>]</span>--<span class="place" data-index="17">[<span class="piece"> </span>]</span>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;<span class="place" data-index="18">[<span class="piece"> </span>]</span>-------<span class="place" data-index="19">[<span class="piece"> </span>]</span>-------<span class="place" data-index="20">[<span class="piece"> </span>]</span>&nbsp;&nbsp;&nbsp;|<br/>
      &nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
      <span class="place" data-index="21">[<span class="piece"> </span>]</span>------------<span class="place" data-index="22">[<span class="piece"> </span>]</span>------------<span class="place" data-index="23">[<span class="piece"> </span>]</span><br/>
    </div>
    <div id="infos"></div>
    <script type="text/javascript">
      window.Game = new Game();
      window.UI = new UI(window.Game);

      var Settings = function() {
        this.init_listeners();
      }
      Settings.prototype.apply = function() {
        this.ai_wait_time.apply();
      }
      Settings.prototype.init_listeners = function() {
        this.ai_wait_time.init_listener();
      }
      Settings.prototype.ai_wait_time = new Object();
      Settings.prototype.ai_wait_time.val = function() {
        return $("#settings input#ai_wait_time").val();
      }
      Settings.prototype.ai_wait_time.init_listener = function() {
        var ai_wait_time = this;
        $("#settings input#ai_wait_time").on('keyup', function() {
          ai_wait_time.apply();
        });
      }
      Settings.prototype.ai_wait_time.apply = function() {
        var ai_wait_time = this;
        $.each(window.AIs, function() {
          this.wait_time = ai_wait_time.val();
        });
      }
      window.Settings = new Settings();

      window.AIs = [];
      var player = null;
      $("#start_buttons button").each(function() {
        $(this).on('click', function() {
          if ($(this).data('player0') == "ai") {
            player = window.Game.players[0];
            window.AIs.push(new AI(window.Game, player));
            window.UI.remove_player(player)
          }
          if ($(this).data('player1') == "ai") {
            player = window.Game.players[1];
            window.AIs.push(new AI(window.Game, player));
            window.UI.remove_player(player)
          }
          window.Settings.apply();
          window.Game.start();
          $("#start_buttons").css('visibility','hidden');
        });
      });
    </script>
  </body>
</html>
